<div ng-init="init()">
  <h3>Issue and Transfer Bitmark</h3>
  <!-- setup section -->
  <div class="panel panel-default">
    <div class="panel-heading">Info</div>
    <div class="panel-body">
      <p ng-show="showSetup">Setup an identity in bitmark and a bitcoin wallet to issue and transfer your assets. </p>
      <div ng-show="!showSetup">
        <uib-alert type="danger" close="clearErrAlert('status')" ng-if="bitmarkPayError != null">
          {{bitmarkPayError}}
        </uib-alert>
        <p>
          <b>Chain</b>
          {{onestepStatusResult.network}}
        </p>
        <p>
          <b>Connect</b>
          {{onestepStatusResult.connect}}
        </p>
        <p>
          <b>Identity Name</b>
          {{onestepStatusResult.identities[0].name}}
        </p>
        <p>
          <b>Identity Description</b>
          {{onestepStatusResult.identities[0].description}}
        </p>
        <p>
          <b>Identity Publickey</b>
          {{onestepStatusResult.identities[0].public_key}}
        </p>
        <p>
          <b>Bitcoin Address</b>
          {{onestepStatusResult.address}}
        </p>
        <p>
          <b>Estimated Balance</b>
          {{onestepStatusResult.estimated_balance}}
        </p>
        <p>
          <b>Available Balance</b>
          {{onestepStatusResult.available_balance}}
        </p>
      </div>
    </div>
  </div>

  <!-- add setup fields -->
  <div class="panel panel-default" ng-show="showSetup">
    <div class="panel-heading">
      Setup
    </div>
    <div clsaa="panel-body">
      <div ng-show="setupError != ''">
        {{setupError}}
      </div>
      <form name="setupForm">
        <div class="panel-body">
          <p>
            <b>Chain</b>
            {{bitmarkChain}}
          </p>
          <p>
            <label>
              Connect
              <input type="text" ng-model="bitmarkSetupConfig.connect" required>
            </label>
          </p>
          <p>
            <label>
              Identity Name
              <input type="text" ng-model="bitmarkSetupConfig.identity" required>
            </label>
          </p>
          <p>
            <label>
              Identity Description
              <textarea ng-model="bitmarkSetupConfig.description" required></textarea>
            </label>
          </p>
          <p>
            <label>
              Identity Password
              <password-set password="bitmarkSetupConfig.cli_password" result="cliPasswordResult"></password-set>
            </label>
          </p>
          <p>
            <label>
              Pay Password
              <password-set password="bitmarkSetupConfig.pay_password" result="payPasswordResult"></password-set>
            </label>
          </p>
        </div>
        <button ng-click="submitSetup()">submit</button>
      </form>
    </div>
  </div>

    
    <!-- Issue setction -->
    <uib-accordion-group is-open="issueAccord.open" ng-show="!showSetup">
      <uib-accordion-heading>
        Issue Asset
        <i class="pull-right glyphicon" ng-class="{'glyphicon-chevron-down': issueAccord.open, 'glyphicon-chevron-right': !issueAccord.open}"></i>
      </uib-accordion-heading>

      <!--  alert -->
      <uib-alert type="{{issueResult.type}}" close="clearErrAlert('issue')" ng-if="issueResult != null">
        <b>{{issueResult.msg}}</b>
        <div ng-show="issueResult.cliResult != null">
          <span ng-repeat="index in issueResult.cliResult.issueIds track by $index">
            <div>
              <b>
                {{$index+1}}
                <span ng-if="issueResult.failStart != null && $index >= issueResult.failStart">
                  Pay Failed
                </span>
                <span ng-if="issueResult.failStart == null || $index < issueResult.failStart">
                  Pay Success
                </span>
              </b>
            </div>
            <div>
              <b>txid</b>
              {{issueResult.cliResult.issueIds[$index]}}
            </div>
            <div>
              <b>currency</b>
              {{issueResult.cliResult.paymentAddress[0].currency}}
            </div>
            <div>
              <b>address</b>
              {{issueResult.cliResult.paymentAddress[0].address}}
            </div>
          </span>
        </div>
      </uib-alert>

      <form>
        <div class="panel-body">
          <p>
            <label>
              Name
              <input type="text" ng-model="bitmarkIssueConfig.asset" required>
            </label>
          </p>
          <p>
            <label>
              Description
              <textarea ng-model="bitmarkIssueConfig.description" required></textarea>
            </label>
          </p>
          <p>
            <fingerprint-input file="file" fingerprint="bitmarkIssueConfig.fingerprint"></fingerprint-input>
            <label>
              Fingerprint
              {{bitmarkIssueConfig.fingerprint}}
            </label>
          </p>
          
          <p>
            <label>
              Quantity
              <input type="number" ng-model="bitmarkIssueConfig.quantity" required>
            </label>
          </p>
          <p>
            <label>
              Identity Password
              <input type="password" ng-model="bitmarkIssueConfig.cli_password" required>
            </label>
          </p>
          <p>
            <label>
              Pay Password
              <input type="password" ng-model="bitmarkIssueConfig.pay_password" required>
            </label>
          </p>        
        </div>
        <button ng-click="submitIssue()">submit</button>
      </form>
    </uib-accordion-group>

    <!-- Transfer setction -->
    <uib-accordion-group is-open="transferAccord.open" ng-show="!showSetup">
      <uib-accordion-heading>
        Transfer Bitmark
        <i class="pull-right glyphicon" ng-class="{'glyphicon-chevron-down': transferAccord.open, 'glyphicon-chevron-right': !transferAccord.open}"></i>
      </uib-accordion-heading>

      <!--  alert -->
      <uib-alert type="{{transferResult.type}}" close="clearErrAlert('transfer')" ng-if="transferResult != null">
        <b>{{transferResult.msg}}</b>
        <div ng-show="transferResult.cliResult != null">
          <div>
            <b>txid</b>
            {{transferResult.cliResult.issueIds[$index]}}
          </div>
          <div>
            <b>currency</b>
            {{transferResult.cliResult.paymentAddress[0].currency}}
          </div>
          <div>
            <b>address</b>
            {{transferResult.cliResult.paymentAddress[0].address}}
          </div>
        </div>
      </uib-alert>
      
      <form>
        <div class="panel-body">
          <p>
            <label>
              Transaction Id
              <input type="text" ng-model="bitmarkTransferConfig.txid" required>
            </label>
          </p>
          <p>
            <label>
              Receiver
              <input type="text" ng-model="bitmarkTransferConfig.receiver" required>
            </label>
          </p>
          <p>
            <label>
              Identity Password
              <input type="password" ng-model="bitmarkTransferConfig.cli_password" required>
            </label>
          </p>
          <p>
            <label>
              Pay Password
              <input type="password" ng-model="bitmarkTransferConfig.pay_password" required>
            </label>
          </p>        
        </div>
        <button ng-click="submitTransfer()">submit</button>
      </form>
    </uib-accordion-group>
  </uib-accordion>
</div>
